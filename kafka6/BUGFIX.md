# Ğ˜ÑĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ Ğº Kafka

## ğŸ› ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ°

ĞŸÑ€Ğ¸ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ğ¸ `make check` Ğ²Ğ¾Ğ·Ğ½Ğ¸ĞºĞ°Ğ»Ğ° Ğ¾ÑˆĞ¸Ğ±ĞºĞ°:

```
Error while executing topic command : Topic 'replication-test' does not exist as expected
Connection to node 2 (localhost/127.0.0.1:9093) could not be established
Connection to node 3 (localhost/127.0.0.1:9094) could not be established
```

## ğŸ” ĞŸÑ€Ğ¸Ñ‡Ğ¸Ğ½Ğ°

Ğ¡ĞºÑ€Ğ¸Ğ¿Ñ‚Ñ‹ Ğ¿Ñ‹Ñ‚Ğ°Ğ»Ğ¸ÑÑŒ Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡Ğ¸Ñ‚ÑŒÑÑ Ğº Kafka Ñ‡ĞµÑ€ĞµĞ· `localhost:9092/9093/9094`, Ğ½Ğ¾:

1. **Ğ’Ğ½ÑƒÑ‚Ñ€Ğ¸ Docker ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ğ°** `localhost` ÑƒĞºĞ°Ğ·Ñ‹Ğ²Ğ°ĞµÑ‚ Ğ½Ğ° ÑĞ°Ğ¼ ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€, Ğ° Ğ½Ğµ Ğ½Ğ° Ñ…Ğ¾ÑÑ‚
2. Kafka Ğ±Ñ€Ğ¾ĞºĞµÑ€Ñ‹ ÑĞ»ÑƒÑˆĞ°ÑÑ‚ Ğ½Ğ° **Ğ²Ğ½ÑƒÑ‚Ñ€ĞµĞ½Ğ½Ğ¸Ñ… Docker Ğ°Ğ´Ñ€ĞµÑĞ°Ñ…**: `kafka1:29092`, `kafka2:29093`, `kafka3:29094`
3. ĞŸĞ¾Ñ€Ñ‚Ñ‹ `9092/9093/9094` - ÑÑ‚Ğ¾ **PLAINTEXT_HOST** listeners Ğ´Ğ»Ñ **Ğ²Ğ½ĞµÑˆĞ½Ğ¸Ñ… Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğ¹ Ñ Ñ…Ğ¾ÑÑ‚Ğ°**
4. ĞŸĞ¾Ñ€Ñ‚Ñ‹ `29092/29093/29094` - ÑÑ‚Ğ¾ **PLAINTEXT** listeners Ğ´Ğ»Ñ **Ğ²Ğ½ÑƒÑ‚Ñ€ĞµĞ½Ğ½Ğ¸Ñ… inter-broker** Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğ¹

## âœ… Ğ ĞµÑˆĞµĞ½Ğ¸Ğµ

### 1. Ğ£Ğ´Ğ°Ğ»ĞµĞ½Ğ¾ ÑƒÑÑ‚Ğ°Ñ€ĞµĞ²ÑˆĞµĞµ Ğ¿Ñ€ĞµĞ´ÑƒĞ¿Ñ€ĞµĞ¶Ğ´ĞµĞ½Ğ¸Ğµ

**Ğ¤Ğ°Ğ¹Ğ»:** `docker-compose.yml`

```diff
- version: '3.8'
-
  services:
```

### 2. Ğ˜ÑĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ñ‹ bootstrap-server Ğ°Ğ´Ñ€ĞµÑĞ°

**Ğ¤Ğ°Ğ¹Ğ»Ñ‹:** 
- `scripts/02-create-topic.sh`
- `scripts/03-check-isr.sh`
- `scripts/experiment-failover.sh`
- `scripts/experiment-min-isr.sh`
- `Makefile`

```diff
- --bootstrap-server localhost:9092
+ --bootstrap-server kafka1:29092,kafka2:29093,kafka3:29094
```

## ğŸ“Š ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğ¹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Host Machine                         â”‚
â”‚                                                          â”‚
â”‚  Java Producer/Consumer                                 â”‚
â”‚  â””â”€â†’ localhost:9092,9093,9094 (PLAINTEXT_HOST)         â”‚
â”‚         â”‚                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Docker Network (kafka-network)             â”‚
â”‚                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ kafka1  â”‚â—„â”€â”€â”€â”€â–ºâ”‚ kafka2  â”‚â—„â”€â”€â”€â”€â–ºâ”‚ kafka3  â”‚        â”‚
â”‚  â”‚ :29092  â”‚      â”‚ :29093  â”‚      â”‚ :29094  â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚       â–²                â–²                 â–²              â”‚
â”‚       â”‚                â”‚                 â”‚              â”‚
â”‚  Ğ¡ĞºÑ€Ğ¸Ğ¿Ñ‚Ñ‹ Ğ²Ğ½ÑƒÑ‚Ñ€Ğ¸ ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ğ° Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒÑÑ‚:                 â”‚
â”‚  kafka1:29092,kafka2:29093,kafka3:29094                â”‚
â”‚                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ¯ ĞŸÑ€Ğ°Ğ²Ğ¸Ğ»Ğ¾

**ĞÑ‚ĞºÑƒĞ´Ğ° Ğ·Ğ°Ğ¿ÑƒÑĞºĞ°ĞµÑ‚ÑÑ?** â†’ **ĞšĞ°ĞºĞ¾Ğ¹ Ğ°Ğ´Ñ€ĞµÑ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ?**

| ĞÑ‚ĞºÑƒĞ´Ğ° | ĞĞ´Ñ€ĞµÑ | ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ |
|--------|-------|--------|
| **Ğ¥Ğ¾ÑÑ‚** (Ğ²Ğ°ÑˆĞ° Ğ¼Ğ°ÑˆĞ¸Ğ½Ğ°) | `localhost:9092,9093,9094` | Java Producer Ğ½Ğ° Ñ…Ğ¾ÑÑ‚Ğµ |
| **Ğ’Ğ½ÑƒÑ‚Ñ€Ğ¸ ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ğ°** | `kafka1:29092,kafka2:29093,kafka3:29094` | Ğ¡ĞºÑ€Ğ¸Ğ¿Ñ‚Ñ‹ Ñ docker-compose exec |
| **Ğ”Ñ€ÑƒĞ³Ğ¾Ğ¹ ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€** | `kafka1:29092,kafka2:29093,kafka3:29094` | Ğ”Ñ€ÑƒĞ³Ğ¾Ğ¹ ÑĞµÑ€Ğ²Ğ¸Ñ Ğ² docker-compose |

## âœ¨ Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚

ĞŸĞ¾ÑĞ»Ğµ Ğ¸ÑĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğ¹:

```bash
$ make topic
âœ… Created topic replication-test

$ make check
âœ… Topic: replication-test
   Partition 0: Leader=3, ISR=[3,1,2]
   Partition 1: Leader=1, ISR=[1,2,3]
   Partition 2: Leader=2, ISR=[2,3,1]
```

## ğŸš€ Ğ¢ĞµĞ¿ĞµÑ€ÑŒ Ğ²ÑÑ‘ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚!

ĞŸÑ€Ğ¾Ğ´Ğ¾Ğ»Ğ¶Ğ°Ğ¹Ñ‚Ğµ Ñ:

```bash
make produce    # ĞÑ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ° ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğ¹
make consume    # Ğ§Ñ‚ĞµĞ½Ğ¸Ğµ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğ¹
make experiments # Ğ­ĞºÑĞ¿ĞµÑ€Ğ¸Ğ¼ĞµĞ½Ñ‚Ñ‹
```

## ğŸ“ Ğ—Ğ°Ğ¼ĞµÑ‚ĞºĞ¸ Ğ´Ğ»Ñ Ğ±ÑƒĞ´ÑƒÑ‰ĞµĞ³Ğ¾

1. **Ğ”Ğ»Ñ Java Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğ¹ Ğ½Ğ° Ñ…Ğ¾ÑÑ‚Ğµ** - Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞ¹Ñ‚Ğµ `localhost:9092,9093,9094`
2. **Ğ”Ğ»Ñ ÑĞºÑ€Ğ¸Ğ¿Ñ‚Ğ¾Ğ² Ğ²Ğ½ÑƒÑ‚Ñ€Ğ¸ ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ğ¾Ğ²** - Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞ¹Ñ‚Ğµ `kafka1:29092,kafka2:29093,kafka3:29094`
3. **Listeners Ğ² Kafka**:
   - `PLAINTEXT://kafka1:29092` - Ğ´Ğ»Ñ inter-broker communication
   - `PLAINTEXT_HOST://localhost:9092` - Ğ´Ğ»Ñ Ğ²Ğ½ĞµÑˆĞ½Ğ¸Ñ… ĞºĞ»Ğ¸ĞµĞ½Ñ‚Ğ¾Ğ²

---

**Ğ”Ğ°Ñ‚Ğ° Ğ¸ÑĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ:** 2026-02-20  
**Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ:** âœ… Ğ˜ÑĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¾ Ğ¸ Ğ¿Ñ€Ğ¾Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¾
